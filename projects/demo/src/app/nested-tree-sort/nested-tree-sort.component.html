<ng-container [ngTemplateOutlet]="tree" [ngTemplateOutletContext]="{ $implicit: items }"></ng-container>

<button (click)="add()">add</button>

<ng-template #tree let-items>
  <div
    ngxDropList
    class="example-list"
    (drop)="drop($event)"
    [data]="items"
    *ngIf="items && items.length > 0"
    id="base">
    @for (item of items; track item) {
    <div
      class="example-box"
      ngxDraggable
      #drgItem
      (dragStart)="currentDragItem = drgItem"
      (dragend)="currentDragItem = undefined"
      (mousemove)="handleEnterd($event, item, drgItem)"
      [class.entered]="item.entered"
      [id]="item.name">
      <div>{{ item.name }} - {{ item._dragAction }} - entered: {{ item.entered }}</div>
      <div class="children" ngxDropList (drop)="drop($event)" [data]="item.children" [id]="'child_' + item.name">
        <ng-container
          *ngIf="item.children"
          [ngTemplateOutlet]="tree"
          [ngTemplateOutletContext]="{ $implicit: item.children }"></ng-container>
      </div>
    </div>
    }
  </div>
</ng-template>
